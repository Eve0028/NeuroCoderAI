# Dla małego N

## 1. Miary neurofizjologiczne
### 1.1. Moc pasmowa w ujęciu logarytmicznym
Dla sygnału EEG x(t), moc w paśmie \[f1​, f2\]​ (np. θ=4−7 Hz) obliczamy jako:
$$
P_{[f_1,f_2]} = \frac{1}{N} \sum_{f=f_1}^{f_2} |X(f)|^2
$$
gdzie X(f) to transformata Fouriera sygnału lub wynik metody Welch’a.
Ponieważ rozkład mocy EEG jest silnie skośny (prawo długiego ogona), używa się **transformacji logarytmicznej**
$$
\log P_{[f_1,f_2]} = \ln(P_{[f_1,f_2]} + \epsilon)
$$
- **Interpretacja:** wzrost log⁡P_θ​ w Fz/FCz odzwierciedla aktywację frontal-midline theta -> procesy kontroli poznawczej i wysiłku umysłowego.
- **Kanały priorytetowe:**
    - θ: Fz/FCz (kontrola poznawcza, obciążenie robocze).
    - β: Cz/Fz (pobudzenie, motoryka, możliwe markery obciążenia).

### 1.2. ERD/ERS (Event-Related Desynchronization/Synchronization)
Względna zmiana mocy pasma w czasie zadania względem baseline.
$$
\mathrm{ERD}_{\alpha} = \frac{P_{\text{task}, \alpha} - P_{\text{baseline}, \alpha}}{P_{\text{baseline}, \alpha}}
$$
- Dla α\alphaα (8–12 Hz), mierzone zwykle w Pz/Oz (obszary ciemieniowo-potyliczne):
    - **ERD (ujemne wartości):** spadek mocy alfa -> wzrost uwagi, aktywacja kory, obciążenie poznawcze.
    - **ERS (dodatnie wartości):** wzrost mocy alfa -> zmniejszone przetwarzanie, „idling”
- Oczekujemy **silniejszego ERD_α​** w AI-OFF (więcej wysiłku) niż w AI-ON.

### 1.3. Indeksy różnicowe (delta warunków)
Ponieważ każdy uczestnik jest „swoją własną kontrolą”, podstawową jednostką analizy jest różnica:
$$
\Delta M = M_{\text{AI-ON}} - M_{\text{AI-OFF}}
$$
gdzie M to log⁡P_θ, log⁡P_β, ERD_α.
**Interpretacja:**
- Δlog⁡P_θ > 0: AI-ON daje więcej theta niż AI-OFF (więcej wysiłku poznawczego).
- ΔERD_α < 0: AI-ON tłumi alfa bardziej niż OFF (więcej uwagi).

## 2. Analiza w obrębie osoby
Przy N=4 **nie zakładamy uogólnienia do populacji** w sensie klasycznych testów parametrycznych. 
- Przy tak małej grupie próby dla całej grupy byłyby niestabilne i mało wiarygodne.
- Efekty międzyosobnicze (różnice w poziomie umiejętności, doświadczeniu) mogłyby całkowicie zdominować wynik.
Żeby coś było z uogólnienia do populacji najlepiej byłoby mieć minimum 15 osób.

Dlatego:
- **Agregacja w obrębie bloku:** każdy 6–8 min blok daje kilkadziesiąt epok (np. 2 s z 50% overlap). Agregujemy (np. medianą lub średnią) do jednej wartości na blok.
- **Porównania bloków:** dla danej osoby mamy n≈6−8 bloków ON i n≈6−8 bloków OFF -> możemy policzyć różnice.

### 2.1. Test permutacyjny
Nie zakłada normalności ani innych trudnych założeń, świetna przy małym N.

1) **Oblicz obserwowaną różnicę**:
	Przykład: średnia(ON) = 5.3, średnia(OFF) = 6.7 -> Δobs=−1.4
2) **Połącz wszystkie bloki** w jeden „worek” liczb:
	wszystkie_bloki = \[5.3, 5.7, 5.1, 6.2, 6.0, 5.9, 6.7, 6.3, 6.8, 7.0, 6.5, 6.1\]
3) **Losowo przypisz etykiety ON/OFF** do tych bloków, zachowując oryginalną liczbę bloków w każdej grupie (6 i 6).
	- To tworzy „sztuczną sytuację, w której warunek NIE MA wpływu” → hipoteza zerowa.
4) **Policz różnicę średnich** dla tego losowego podziału -> Δ_perm​.
5) **Powtarzaj krok 3–4 wiele razy** (np. 5000 razy) → dostajesz rozkład różnic oczekiwanych przy braku efektu.
6) **Porównaj Δ_obs z tym rozkładem**:
	- Ile razy w permutacjach różnica była większa lub równa ∣Δobs∣|\Delta_\text{obs}|∣Δobs​∣?
	- To daje **empiryczne p-value**: prawdopodobieństwo, że obserwowana różnica powstała przypadkowo.

Ddaje nam to - **p-value** – prawdopodobieństwo, że obserwowana różnica powstała przypadkowo
Porównanie średniej log⁡P_θ lub ERD między AI-ON i AI-OFF **per osoba**
### 2.2. Bootstrap przedziałów ufności
Bootstrap pozwala oszacować **zakres, w którym prawdopodobnie znajduje się prawdziwa różnica** między ON a OFF.
1) **Weź próbkę bloków AI-ON i AI-OFF** – np. 6 bloków ON, 6 bloków OFF.
2) **Losowo wybieraj z powtórzeniami** bloki z każdej grupy.
3) **Oblicz średnią ON i OFF w tej próbce** -> różnica Δ_boot​.
4) **Powtarzaj ten proces tysiące razy** (np. 10 000) → dostajesz rozkład różnic Δ_boot​.
5) **Wyznacz granice przedziału ufności**:
    - Posortuj wszystkie Δ_boot,
    - Dla 95% CI wybierz 2.5% i 97.5% -> to jest **zakres, w którym prawdopodobnie mieści się prawdziwa różnica między warunkami**.

## 3. Łączenie wyników między osobami
### 3.1. Fixed-effects meta-analiza
- Traktujemy efekt każdej osoby (Δ_i​) jako niezależny eksperyment.
- Średnia ważona:
$$
\hat{\Delta} = \frac{\sum_i w_i \Delta_i}{\sum_i w_i}, \quad w_i = \frac{1}{\mathrm{Var}(\Delta_i)}
$$
- Raportujemy łączny efekt + CI.
- **Uwaga:** to nie jest estymacja populacyjna, a „średnia efektów obserwowanych osób”.

## 4. Miary behawioralne jako współzmienne
### 4.1. NASA-TLX (krótka wersja)
- Wynik subiektywny (1-7).
- Można liczyć korelację między Δθ \ ΔERD_α a ΔNASA-TLX.
- Przy małym N najlepiej używać **korelacji permutacyjnych**.
### 4.2. Czas wykonania i błędy
- Obiektywne wskaźniki obciążenia.
- Analiza równoległa do EEG: ON vs OFF (różnice blokowe).
- Można również użyć ich jako kowariatów w prostych regresjach (np. czy większe ERD_α przewiduje krótszy czas).


**Podsumowanie**:
- Dla każdej osoby liczymy: log⁡P_θ, log⁡P_β, ERD_α​.
- W każdym bloku: agregacja epok -> 1 wartość.
- Porównania ON vs OFF: permutacja + bootstrap CI.
- Następnie: meta-analiza efektów cząstkowych (Δ) między osobami.
- Dodatkowo: NASA-TLX i czas/błędy jako miary wspierające.